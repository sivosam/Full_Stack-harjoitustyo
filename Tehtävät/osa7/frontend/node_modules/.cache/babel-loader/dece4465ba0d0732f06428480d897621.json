{"ast":null,"code":"import _defineProperty from \"/Users/Kullervo/Githubailua/Full_Stack-harjoitustyo/Tehta\\u0308va\\u0308t/osa7/frontend/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"/Users/Kullervo/Githubailua/Full_Stack-harjoitustyo/Tehta\\u0308va\\u0308t/osa7/frontend/node_modules/@babel/runtime/regenerator\";\nimport _objectSpread from \"/Users/Kullervo/Githubailua/Full_Stack-harjoitustyo/Tehta\\u0308va\\u0308t/osa7/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _asyncToGenerator from \"/Users/Kullervo/Githubailua/Full_Stack-harjoitustyo/Tehta\\u0308va\\u0308t/osa7/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/Kullervo/Githubailua/Full_Stack-harjoitustyo/Tehta\\u0308va\\u0308t/osa7/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/Kullervo/Githubailua/Full_Stack-harjoitustyo/Tehta\\u0308va\\u0308t/osa7/frontend/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/Kullervo/Githubailua/Full_Stack-harjoitustyo/Tehta\\u0308va\\u0308t/osa7/frontend/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/Kullervo/Githubailua/Full_Stack-harjoitustyo/Tehta\\u0308va\\u0308t/osa7/frontend/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/Kullervo/Githubailua/Full_Stack-harjoitustyo/Tehta\\u0308va\\u0308t/osa7/frontend/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/Kullervo/Githubailua/Full_Stack-harjoitustyo/Tehta\\u0308va\\u0308t/osa7/frontend/src/App.js\";\nimport React from 'react';\nimport Blog from './components/Blog';\nimport BlogForm from './components/BlogForm';\nimport Notification from './components/Notification';\nimport Togglable from './components/Togglable';\nimport blogService from './services/blogs';\nimport loginService from './services/login';\n\nvar App =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(App, _React$Component);\n\n  function App(props) {\n    var _this;\n\n    _classCallCheck(this, App);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(App).call(this, props));\n\n    _this.notify = function (message) {\n      var type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'info';\n\n      _this.setState({\n        notification: {\n          message: message,\n          type: type\n        }\n      });\n\n      setTimeout(function () {\n        _this.setState({\n          notification: null\n        });\n      }, 10000);\n    };\n\n    _this.like = function (id) {\n      return (\n        /*#__PURE__*/\n        _asyncToGenerator(\n        /*#__PURE__*/\n        _regeneratorRuntime.mark(function _callee() {\n          var liked, updated;\n          return _regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  liked = _this.state.blogs.find(function (b) {\n                    return b._id === id;\n                  });\n                  updated = _objectSpread({}, liked, {\n                    likes: liked.likes + 1\n                  });\n                  _context.next = 4;\n                  return blogService.update(id, updated);\n\n                case 4:\n                  _this.notify(\"you liked '\".concat(updated.title, \"' by \").concat(updated.author));\n\n                  _this.setState({\n                    blogs: _this.state.blogs.map(function (b) {\n                      return b._id === id ? updated : b;\n                    })\n                  });\n\n                case 6:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee, this);\n        }))\n      );\n    };\n\n    _this.remove = function (id) {\n      return (\n        /*#__PURE__*/\n        _asyncToGenerator(\n        /*#__PURE__*/\n        _regeneratorRuntime.mark(function _callee2() {\n          var deleted, ok;\n          return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n            while (1) {\n              switch (_context2.prev = _context2.next) {\n                case 0:\n                  deleted = _this.state.blogs.find(function (b) {\n                    return b._id === id;\n                  });\n                  ok = window.confirm(\"remove blog '\".concat(deleted.title, \"' by \").concat(deleted.author, \"?\"));\n\n                  if (!(ok === false)) {\n                    _context2.next = 4;\n                    break;\n                  }\n\n                  return _context2.abrupt(\"return\");\n\n                case 4:\n                  _context2.next = 6;\n                  return blogService.remove(id);\n\n                case 6:\n                  _this.notify(\"blog '\".concat(deleted.title, \"' by \").concat(deleted.author, \" removed\"));\n\n                  _this.setState({\n                    blogs: _this.state.blogs.filter(function (b) {\n                      return b._id !== id;\n                    })\n                  });\n\n                case 8:\n                case \"end\":\n                  return _context2.stop();\n              }\n            }\n          }, _callee2, this);\n        }))\n      );\n    };\n\n    _this.addBlog =\n    /*#__PURE__*/\n    function () {\n      var _ref3 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3(event) {\n        var blog, result;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                event.preventDefault();\n                blog = {\n                  title: _this.state.title,\n                  author: _this.state.author,\n                  url: _this.state.url\n                };\n                _context3.next = 4;\n                return blogService.create(blog);\n\n              case 4:\n                result = _context3.sent;\n\n                _this.notify(\"blog '\".concat(blog.title, \"' by \").concat(blog.author, \" added\"));\n\n                _this.setState({\n                  title: '',\n                  url: '',\n                  author: '',\n                  blogs: _this.state.blogs.concat(result)\n                });\n\n              case 7:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      return function (_x) {\n        return _ref3.apply(this, arguments);\n      };\n    }();\n\n    _this.logout = function () {\n      window.localStorage.removeItem('loggedBlogAppUser');\n\n      _this.notify('logged out');\n\n      _this.setState({\n        user: null\n      });\n    };\n\n    _this.login =\n    /*#__PURE__*/\n    function () {\n      var _ref4 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee4(event) {\n        var user;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                event.preventDefault();\n                _context4.prev = 1;\n                _context4.next = 4;\n                return loginService.login({\n                  username: _this.state.username,\n                  password: _this.state.password\n                });\n\n              case 4:\n                user = _context4.sent;\n                window.localStorage.setItem('loggedBlogAppUser', JSON.stringify(user));\n                blogService.setToken(user.token);\n\n                _this.notify('welcome back!');\n\n                _this.setState({\n                  username: '',\n                  password: '',\n                  user: user\n                });\n\n                _context4.next = 15;\n                break;\n\n              case 11:\n                _context4.prev = 11;\n                _context4.t0 = _context4[\"catch\"](1);\n\n                _this.notify('käyttäjätunnus tai salasana virheellinen', 'error');\n\n                setTimeout(function () {\n                  _this.setState({\n                    error: null\n                  });\n                }, 5000);\n\n              case 15:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this, [[1, 11]]);\n      }));\n\n      return function (_x2) {\n        return _ref4.apply(this, arguments);\n      };\n    }();\n\n    _this.handleLoginChange = function (event) {\n      _this.setState(_defineProperty({}, event.target.name, event.target.value));\n    };\n\n    _this.state = {\n      blogs: [],\n      user: null,\n      username: '',\n      password: '',\n      title: '',\n      author: '',\n      url: '',\n      notification: null\n    };\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      var _this2 = this;\n\n      blogService.getAll().then(function (blogs) {\n        return _this2.setState({\n          blogs: blogs\n        });\n      });\n      var loggedUserJSON = window.localStorage.getItem('loggedBlogAppUser');\n\n      if (loggedUserJSON) {\n        var user = JSON.parse(loggedUserJSON);\n        this.setState({\n          user: user\n        });\n        blogService.setToken(user.token);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      if (this.state.user === null) {\n        return React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 124\n          },\n          __self: this\n        }, React.createElement(Notification, {\n          notification: this.state.notification,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 125\n          },\n          __self: this\n        }), React.createElement(\"h2\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 126\n          },\n          __self: this\n        }, \"Kirjaudu sovellukseen\"), React.createElement(\"form\", {\n          onSubmit: this.login,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 127\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 128\n          },\n          __self: this\n        }, \"k\\xE4ytt\\xE4j\\xE4tunnus\", React.createElement(\"input\", {\n          type: \"text\",\n          name: \"username\",\n          value: this.state.username,\n          onChange: this.handleLoginChange,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 130\n          },\n          __self: this\n        })), React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 137\n          },\n          __self: this\n        }, \"salasana\", React.createElement(\"input\", {\n          type: \"password\",\n          name: \"password\",\n          value: this.state.password,\n          onChange: this.handleLoginChange,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 139\n          },\n          __self: this\n        })), React.createElement(\"button\", {\n          type: \"submit\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 146\n          },\n          __self: this\n        }, \"kirjaudu\")));\n      }\n\n      var byLikes = function byLikes(b1, b2) {\n        return b2.likes - b1.likes;\n      };\n\n      var blogsInOrder = this.state.blogs.sort(byLikes);\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157\n        },\n        __self: this\n      }, React.createElement(Notification, {\n        notification: this.state.notification,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158\n        },\n        __self: this\n      }), this.state.user.name, \" logged in \", React.createElement(\"button\", {\n        onClick: this.logout,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160\n        },\n        __self: this\n      }, \"logout\"), React.createElement(Togglable, {\n        buttonLabel: \"uusi blogi\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 162\n        },\n        __self: this\n      }, React.createElement(BlogForm, {\n        handleChange: this.handleLoginChange,\n        title: this.state.title,\n        author: this.state.author,\n        url: this.state.url,\n        handleSubmit: this.addBlog,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 163\n        },\n        __self: this\n      })), React.createElement(\"h2\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 172\n        },\n        __self: this\n      }, \"blogs\"), blogsInOrder.map(function (blog) {\n        return React.createElement(Blog, {\n          key: blog._id,\n          blog: blog,\n          like: _this3.like(blog._id),\n          remove: _this3.remove(blog._id),\n          deletable: blog.user === undefined || blog.user.username === _this3.state.user.username,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 174\n          },\n          __self: this\n        });\n      }));\n    }\n  }]);\n\n  return App;\n}(React.Component);\n\nexport default App;","map":{"version":3,"sources":["/Users/Kullervo/Githubailua/Full_Stack-harjoitustyo/Tehtävät/osa7/frontend/src/App.js"],"names":["React","Blog","BlogForm","Notification","Togglable","blogService","loginService","App","props","notify","message","type","setState","notification","setTimeout","like","id","liked","state","blogs","find","b","_id","updated","likes","update","title","author","map","remove","deleted","ok","window","confirm","filter","addBlog","event","preventDefault","blog","url","create","result","concat","logout","localStorage","removeItem","user","login","username","password","setItem","JSON","stringify","setToken","token","error","handleLoginChange","target","name","value","getAll","then","loggedUserJSON","getItem","parse","byLikes","b1","b2","blogsInOrder","sort","undefined","Component"],"mappings":";;;;;;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,IAAP,MAAiB,mBAAjB;AACA,OAAOC,QAAP,MAAqB,uBAArB;AACA,OAAOC,YAAP,MAAyB,2BAAzB;AACA,OAAOC,SAAP,MAAsB,wBAAtB;AACA,OAAOC,WAAP,MAAwB,kBAAxB;AACA,OAAOC,YAAP,MAAyB,kBAAzB;;IAEMC,G;;;;;AACJ,eAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AACjB,6EAAMA,KAAN;;AADiB,UA0BnBC,MA1BmB,GA0BV,UAACC,OAAD,EAA4B;AAAA,UAAlBC,IAAkB,uEAAX,MAAW;;AACnC,YAAKC,QAAL,CAAc;AACZC,QAAAA,YAAY,EAAE;AACZH,UAAAA,OAAO,EAAPA,OADY;AACHC,UAAAA,IAAI,EAAJA;AADG;AADF,OAAd;;AAKAG,MAAAA,UAAU,CAAC,YAAM;AACf,cAAKF,QAAL,CAAc;AACZC,UAAAA,YAAY,EAAE;AADF,SAAd;AAGD,OAJS,EAIP,KAJO,CAAV;AAKD,KArCkB;;AAAA,UAuCnBE,IAvCmB,GAuCZ,UAACC,EAAD;AAAA;AAAA;AAAA;AAAA;AAAA,iCAAQ;AAAA;AAAA;AAAA;AAAA;AAAA;AACPC,kBAAAA,KADO,GACC,MAAKC,KAAL,CAAWC,KAAX,CAAiBC,IAAjB,CAAsB,UAAAC,CAAC;AAAA,2BAAEA,CAAC,CAACC,GAAF,KAAQN,EAAV;AAAA,mBAAvB,CADD;AAEPO,kBAAAA,OAFO,qBAEQN,KAFR;AAEeO,oBAAAA,KAAK,EAAEP,KAAK,CAACO,KAAN,GAAc;AAFpC;AAAA;AAAA,yBAGPnB,WAAW,CAACoB,MAAZ,CAAmBT,EAAnB,EAAuBO,OAAvB,CAHO;;AAAA;AAIb,wBAAKd,MAAL,sBAA0Bc,OAAO,CAACG,KAAlC,kBAA+CH,OAAO,CAACI,MAAvD;;AACA,wBAAKf,QAAL,CAAc;AACZO,oBAAAA,KAAK,EAAE,MAAKD,KAAL,CAAWC,KAAX,CAAiBS,GAAjB,CAAqB,UAAAP,CAAC;AAAA,6BAAIA,CAAC,CAACC,GAAF,KAAUN,EAAV,GAAeO,OAAf,GAAyBF,CAA7B;AAAA,qBAAtB;AADK,mBAAd;;AALa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAR;AAAA;AAAA,KAvCY;;AAAA,UAiDnBQ,MAjDmB,GAiDV,UAACb,EAAD;AAAA;AAAA;AAAA;AAAA;AAAA,iCAAQ;AAAA;AAAA;AAAA;AAAA;AAAA;AACTc,kBAAAA,OADS,GACC,MAAKZ,KAAL,CAAWC,KAAX,CAAiBC,IAAjB,CAAsB,UAAAC,CAAC;AAAA,2BAAIA,CAAC,CAACC,GAAF,KAAUN,EAAd;AAAA,mBAAvB,CADD;AAETe,kBAAAA,EAFS,GAEJC,MAAM,CAACC,OAAP,wBAA+BH,OAAO,CAACJ,KAAvC,kBAAoDI,OAAO,CAACH,MAA5D,OAFI;;AAAA,wBAGVI,EAAE,KAAG,KAHK;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA,yBAOT1B,WAAW,CAACwB,MAAZ,CAAmBb,EAAnB,CAPS;;AAAA;AAQf,wBAAKP,MAAL,iBAAqBqB,OAAO,CAACJ,KAA7B,kBAA0CI,OAAO,CAACH,MAAlD;;AACA,wBAAKf,QAAL,CAAc;AACZO,oBAAAA,KAAK,EAAE,MAAKD,KAAL,CAAWC,KAAX,CAAiBe,MAAjB,CAAwB,UAAAb,CAAC;AAAA,6BAAEA,CAAC,CAACC,GAAF,KAAQN,EAAV;AAAA,qBAAzB;AADK,mBAAd;;AATe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAR;AAAA;AAAA,KAjDU;;AAAA,UA+DnBmB,OA/DmB;AAAA;AAAA;AAAA;AAAA;AAAA,+BA+DT,kBAAOC,KAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AACRA,gBAAAA,KAAK,CAACC,cAAN;AACMC,gBAAAA,IAFE,GAEK;AACXZ,kBAAAA,KAAK,EAAE,MAAKR,KAAL,CAAWQ,KADP;AAEXC,kBAAAA,MAAM,EAAE,MAAKT,KAAL,CAAWS,MAFR;AAGXY,kBAAAA,GAAG,EAAE,MAAKrB,KAAL,CAAWqB;AAHL,iBAFL;AAAA;AAAA,uBAQalC,WAAW,CAACmC,MAAZ,CAAmBF,IAAnB,CARb;;AAAA;AAQFG,gBAAAA,MARE;;AASR,sBAAKhC,MAAL,iBAAqB6B,IAAI,CAACZ,KAA1B,kBAAuCY,IAAI,CAACX,MAA5C;;AACA,sBAAKf,QAAL,CAAc;AACZc,kBAAAA,KAAK,EAAE,EADK;AAEZa,kBAAAA,GAAG,EAAE,EAFO;AAGZZ,kBAAAA,MAAM,EAAE,EAHI;AAIZR,kBAAAA,KAAK,EAAE,MAAKD,KAAL,CAAWC,KAAX,CAAiBuB,MAAjB,CAAwBD,MAAxB;AAJK,iBAAd;;AAVQ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OA/DS;;AAAA;AAAA;AAAA;AAAA;;AAAA,UAiFnBE,MAjFmB,GAiFV,YAAM;AACbX,MAAAA,MAAM,CAACY,YAAP,CAAoBC,UAApB,CAA+B,mBAA/B;;AACA,YAAKpC,MAAL,CAAY,YAAZ;;AACA,YAAKG,QAAL,CAAc;AAAEkC,QAAAA,IAAI,EAAE;AAAR,OAAd;AACD,KArFkB;;AAAA,UAuFnBC,KAvFmB;AAAA;AAAA;AAAA;AAAA;AAAA,+BAuFX,kBAAOX,KAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AACNA,gBAAAA,KAAK,CAACC,cAAN;AADM;AAAA;AAAA,uBAGe/B,YAAY,CAACyC,KAAb,CAAmB;AACpCC,kBAAAA,QAAQ,EAAE,MAAK9B,KAAL,CAAW8B,QADe;AAEpCC,kBAAAA,QAAQ,EAAE,MAAK/B,KAAL,CAAW+B;AAFe,iBAAnB,CAHf;;AAAA;AAGEH,gBAAAA,IAHF;AAQJd,gBAAAA,MAAM,CAACY,YAAP,CAAoBM,OAApB,CAA4B,mBAA5B,EAAiDC,IAAI,CAACC,SAAL,CAAeN,IAAf,CAAjD;AACAzC,gBAAAA,WAAW,CAACgD,QAAZ,CAAqBP,IAAI,CAACQ,KAA1B;;AACA,sBAAK7C,MAAL,CAAY,eAAZ;;AACA,sBAAKG,QAAL,CAAc;AAAEoC,kBAAAA,QAAQ,EAAE,EAAZ;AAAgBC,kBAAAA,QAAQ,EAAE,EAA1B;AAA8BH,kBAAAA,IAAI,EAAJA;AAA9B,iBAAd;;AAXI;AAAA;;AAAA;AAAA;AAAA;;AAaJ,sBAAKrC,MAAL,CAAY,0CAAZ,EAAwD,OAAxD;;AACAK,gBAAAA,UAAU,CAAC,YAAM;AACf,wBAAKF,QAAL,CAAc;AAAE2C,oBAAAA,KAAK,EAAE;AAAT,mBAAd;AACD,iBAFS,EAEP,IAFO,CAAV;;AAdI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAvFW;;AAAA;AAAA;AAAA;AAAA;;AAAA,UA2GnBC,iBA3GmB,GA2GC,UAACpB,KAAD,EAAW;AAC7B,YAAKxB,QAAL,qBAAiBwB,KAAK,CAACqB,MAAN,CAAaC,IAA9B,EAAqCtB,KAAK,CAACqB,MAAN,CAAaE,KAAlD;AACD,KA7GkB;;AAEjB,UAAKzC,KAAL,GAAa;AACXC,MAAAA,KAAK,EAAE,EADI;AAEX2B,MAAAA,IAAI,EAAE,IAFK;AAGXE,MAAAA,QAAQ,EAAE,EAHC;AAIXC,MAAAA,QAAQ,EAAE,EAJC;AAKXvB,MAAAA,KAAK,EAAE,EALI;AAMXC,MAAAA,MAAM,EAAE,EANG;AAOXY,MAAAA,GAAG,EAAE,EAPM;AAQX1B,MAAAA,YAAY,EAAE;AARH,KAAb;AAFiB;AAYlB;;;;yCAEoB;AAAA;;AACnBR,MAAAA,WAAW,CAACuD,MAAZ,GAAqBC,IAArB,CAA0B,UAAA1C,KAAK;AAAA,eAC7B,MAAI,CAACP,QAAL,CAAc;AAAEO,UAAAA,KAAK,EAALA;AAAF,SAAd,CAD6B;AAAA,OAA/B;AAGA,UAAM2C,cAAc,GAAG9B,MAAM,CAACY,YAAP,CAAoBmB,OAApB,CAA4B,mBAA5B,CAAvB;;AACA,UAAID,cAAJ,EAAoB;AAClB,YAAMhB,IAAI,GAAGK,IAAI,CAACa,KAAL,CAAWF,cAAX,CAAb;AACA,aAAKlD,QAAL,CAAc;AAAEkC,UAAAA,IAAI,EAAJA;AAAF,SAAd;AACAzC,QAAAA,WAAW,CAACgD,QAAZ,CAAqBP,IAAI,CAACQ,KAA1B;AACD;AACF;;;6BAuFQ;AAAA;;AACP,UAAI,KAAKpC,KAAL,CAAW4B,IAAX,KAAoB,IAAxB,EAA8B;AAC5B,eACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACE,oBAAC,YAAD;AAAc,UAAA,YAAY,EAAE,KAAK5B,KAAL,CAAWL,YAAvC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UADF,EAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mCAFF,EAGE;AAAM,UAAA,QAAQ,EAAE,KAAKkC,KAArB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sCAEE;AACE,UAAA,IAAI,EAAC,MADP;AAEE,UAAA,IAAI,EAAC,UAFP;AAGE,UAAA,KAAK,EAAE,KAAK7B,KAAL,CAAW8B,QAHpB;AAIE,UAAA,QAAQ,EAAE,KAAKQ,iBAJjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAFF,CADF,EAUE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAEE;AACE,UAAA,IAAI,EAAC,UADP;AAEE,UAAA,IAAI,EAAC,UAFP;AAGE,UAAA,KAAK,EAAE,KAAKtC,KAAL,CAAW+B,QAHpB;AAIE,UAAA,QAAQ,EAAE,KAAKO,iBAJjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAFF,CAVF,EAmBE;AAAQ,UAAA,IAAI,EAAC,QAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAnBF,CAHF,CADF;AA2BD;;AAED,UAAMS,OAAO,GAAG,SAAVA,OAAU,CAACC,EAAD,EAAKC,EAAL;AAAA,eAAYA,EAAE,CAAC3C,KAAH,GAAW0C,EAAE,CAAC1C,KAA1B;AAAA,OAAhB;;AAEA,UAAM4C,YAAY,GAAG,KAAKlD,KAAL,CAAWC,KAAX,CAAiBkD,IAAjB,CAAsBJ,OAAtB,CAArB;AAEA,aACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,YAAD;AAAc,QAAA,YAAY,EAAE,KAAK/C,KAAL,CAAWL,YAAvC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,EAGG,KAAKK,KAAL,CAAW4B,IAAX,CAAgBY,IAHnB,iBAGmC;AAAQ,QAAA,OAAO,EAAE,KAAKf,MAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAHnC,EAKE,oBAAC,SAAD;AAAW,QAAA,WAAW,EAAC,YAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,QAAD;AACE,QAAA,YAAY,EAAE,KAAKa,iBADrB;AAEE,QAAA,KAAK,EAAE,KAAKtC,KAAL,CAAWQ,KAFpB;AAGE,QAAA,MAAM,EAAE,KAAKR,KAAL,CAAWS,MAHrB;AAIE,QAAA,GAAG,EAAE,KAAKT,KAAL,CAAWqB,GAJlB;AAKE,QAAA,YAAY,EAAE,KAAKJ,OALrB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,CALF,EAeE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAfF,EAgBGiC,YAAY,CAACxC,GAAb,CAAiB,UAAAU,IAAI;AAAA,eACpB,oBAAC,IAAD;AACE,UAAA,GAAG,EAAEA,IAAI,CAAChB,GADZ;AAEE,UAAA,IAAI,EAAEgB,IAFR;AAGE,UAAA,IAAI,EAAE,MAAI,CAACvB,IAAL,CAAUuB,IAAI,CAAChB,GAAf,CAHR;AAIE,UAAA,MAAM,EAAE,MAAI,CAACO,MAAL,CAAYS,IAAI,CAAChB,GAAjB,CAJV;AAKE,UAAA,SAAS,EAAEgB,IAAI,CAACQ,IAAL,KAAcwB,SAAd,IAA2BhC,IAAI,CAACQ,IAAL,CAAUE,QAAV,KAAuB,MAAI,CAAC9B,KAAL,CAAW4B,IAAX,CAAgBE,QAL/E;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UADoB;AAAA,OAArB,CAhBH,CADF;AA4BD;;;;EA/KehD,KAAK,CAACuE,S;;AAkLxB,eAAehE,GAAf","sourcesContent":["import React from 'react'\nimport Blog from './components/Blog'\nimport BlogForm from './components/BlogForm'\nimport Notification from './components/Notification'\nimport Togglable from './components/Togglable'\nimport blogService from './services/blogs'\nimport loginService from './services/login'\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      blogs: [],\n      user: null,\n      username: '',\n      password: '', \n      title: '',\n      author: '',\n      url: '',\n      notification: null\n    }\n  }\n\n  componentWillMount() {\n    blogService.getAll().then(blogs =>\n      this.setState({ blogs })\n    )\n    const loggedUserJSON = window.localStorage.getItem('loggedBlogAppUser')\n    if (loggedUserJSON) {\n      const user = JSON.parse(loggedUserJSON)\n      this.setState({ user })\n      blogService.setToken(user.token)\n    }\n  } \n\n  notify = (message, type = 'info') => {\n    this.setState({\n      notification: {\n        message, type\n      }\n    })\n    setTimeout(() => {\n      this.setState({\n        notification: null\n      })     \n    }, 10000)\n  }\n\n  like = (id) => async () => {\n    const liked = this.state.blogs.find(b=>b._id===id)\n    const updated = { ...liked, likes: liked.likes + 1 }\n    await blogService.update(id, updated)\n    this.notify(`you liked '${updated.title}' by ${updated.author}`)\n    this.setState({\n      blogs: this.state.blogs.map(b => b._id === id ? updated : b)\n    })\n  }\n\n  remove = (id) => async () => {\n    const deleted = this.state.blogs.find(b => b._id === id)\n    const ok = window.confirm(`remove blog '${deleted.title}' by ${deleted.author}?`)\n    if ( ok===false) {\n      return\n    }\n\n    await blogService.remove(id)\n    this.notify(`blog '${deleted.title}' by ${deleted.author} removed`)\n    this.setState({\n      blogs: this.state.blogs.filter(b=>b._id!==id)\n    })\n  }\n\n  addBlog = async (event) => {\n    event.preventDefault()\n    const blog = {\n      title: this.state.title,\n      author: this.state.author,\n      url: this.state.url,\n    }\n    \n    const result = await blogService.create(blog) \n    this.notify(`blog '${blog.title}' by ${blog.author} added`)\n    this.setState({ \n      title: '', \n      url: '', \n      author: '',\n      blogs: this.state.blogs.concat(result)\n    })\n  }\n\n  logout = () => {\n    window.localStorage.removeItem('loggedBlogAppUser')\n    this.notify('logged out')\n    this.setState({ user: null })\n  }\n\n  login = async (event) => {\n    event.preventDefault()\n    try {\n      const user = await loginService.login({\n        username: this.state.username,\n        password: this.state.password\n      })\n\n      window.localStorage.setItem('loggedBlogAppUser', JSON.stringify(user))\n      blogService.setToken(user.token)\n      this.notify('welcome back!')\n      this.setState({ username: '', password: '', user })\n    } catch (exception) {\n      this.notify('käyttäjätunnus tai salasana virheellinen', 'error')\n      setTimeout(() => {\n        this.setState({ error: null })\n      }, 5000)\n    }\n  }\n\n  handleLoginChange = (event) => {\n    this.setState({ [event.target.name]: event.target.value })\n  }\n\n  render() {\n    if (this.state.user === null) {\n      return (\n        <div>\n          <Notification notification={this.state.notification} />\n          <h2>Kirjaudu sovellukseen</h2>\n          <form onSubmit={this.login}>\n            <div>\n              käyttäjätunnus\n              <input\n                type=\"text\"\n                name=\"username\"\n                value={this.state.username}\n                onChange={this.handleLoginChange}\n              />\n            </div>\n            <div>\n              salasana\n              <input\n                type=\"password\"\n                name=\"password\"\n                value={this.state.password}\n                onChange={this.handleLoginChange}\n              />\n            </div>\n            <button type=\"submit\">kirjaudu</button>\n          </form>\n        </div>\n      )\n    }\n\n    const byLikes = (b1, b2) => b2.likes - b1.likes\n\n    const blogsInOrder = this.state.blogs.sort(byLikes)\n\n    return (\n      <div>\n        <Notification notification={this.state.notification} />\n\n        {this.state.user.name} logged in <button onClick={this.logout}>logout</button>\n\n        <Togglable buttonLabel='uusi blogi'>\n          <BlogForm \n            handleChange={this.handleLoginChange}\n            title={this.state.title}\n            author={this.state.author}\n            url={this.state.url}\n            handleSubmit={this.addBlog}\n          />\n        </Togglable>\n\n        <h2>blogs</h2>\n        {blogsInOrder.map(blog => \n          <Blog \n            key={blog._id} \n            blog={blog} \n            like={this.like(blog._id)}\n            remove={this.remove(blog._id)}\n            deletable={blog.user === undefined || blog.user.username === this.state.user.username}\n          />\n        )}\n      </div>\n    );\n  }\n}\n\nexport default App;"]},"metadata":{},"sourceType":"module"}