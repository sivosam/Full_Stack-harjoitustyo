{"ast":null,"code":"import _defineProperty from \"/Users/Kullervo/Githubailua/Full_Stack-harjoitustyo/Tehta\\u0308va\\u0308t/osa7/frontend/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"/Users/Kullervo/Githubailua/Full_Stack-harjoitustyo/Tehta\\u0308va\\u0308t/osa7/frontend/node_modules/@babel/runtime/regenerator\";\nimport _objectSpread from \"/Users/Kullervo/Githubailua/Full_Stack-harjoitustyo/Tehta\\u0308va\\u0308t/osa7/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _asyncToGenerator from \"/Users/Kullervo/Githubailua/Full_Stack-harjoitustyo/Tehta\\u0308va\\u0308t/osa7/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/Kullervo/Githubailua/Full_Stack-harjoitustyo/Tehta\\u0308va\\u0308t/osa7/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/Kullervo/Githubailua/Full_Stack-harjoitustyo/Tehta\\u0308va\\u0308t/osa7/frontend/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/Kullervo/Githubailua/Full_Stack-harjoitustyo/Tehta\\u0308va\\u0308t/osa7/frontend/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/Kullervo/Githubailua/Full_Stack-harjoitustyo/Tehta\\u0308va\\u0308t/osa7/frontend/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/Kullervo/Githubailua/Full_Stack-harjoitustyo/Tehta\\u0308va\\u0308t/osa7/frontend/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/Kullervo/Githubailua/Full_Stack-harjoitustyo/Tehta\\u0308va\\u0308t/osa7/frontend/src/App.js\";\nimport React from 'react';\nimport Blog from './components/Blog';\nimport BlogForm from './components/BlogForm';\nimport Notification from './components/Notification';\nimport Togglable from './components/Togglable';\nimport blogService from './services/blogs';\nimport loginService from './services/login';\nimport { changeNotification } from './reducers/notificationReducer';\nimport { BrowserRouter as Router, Route, Link } from 'react-router-dom';\nimport userService from './services/user';\n\nvar BlogList = function BlogList(_ref) {\n  var list = _ref.list,\n      like = _ref.like,\n      remove = _ref.remove,\n      user = _ref.user;\n  return React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 14\n    },\n    __self: this\n  }, React.createElement(\"h2\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 15\n    },\n    __self: this\n  }, \"blogs\"), list.map(function (blog) {\n    return React.createElement(Blog, {\n      key: blog._id,\n      blog: blog,\n      like: like(blog._id),\n      remove: remove(blog._id),\n      deletable: blog.user === undefined || blog.user.username === user,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 18\n      },\n      __self: this\n    });\n  }));\n};\n\nvar UserList = function UserList(_ref2) {\n  var list = _ref2.list;\n  return React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 31\n    },\n    __self: this\n  }, React.createElement(\"h2\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 32\n    },\n    __self: this\n  }, \"users\"), React.createElement(\"table\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 33\n    },\n    __self: this\n  }, React.createElement(\"thead\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 34\n    },\n    __self: this\n  }, React.createElement(\"tr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 35\n    },\n    __self: this\n  }, React.createElement(\"th\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 36\n    },\n    __self: this\n  }), React.createElement(\"th\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 37\n    },\n    __self: this\n  }, \"blogs added\"))), React.createElement(\"tbody\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 40\n    },\n    __self: this\n  }, list.map(function (user) {\n    return React.createElement(\"tr\", {\n      key: user._id,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 42\n      },\n      __self: this\n    }, React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 43\n      },\n      __self: this\n    }, React.createElement(Link, {\n      to: \"users/\".concat(user._id),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 43\n      },\n      __self: this\n    }, user.name)), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 44\n      },\n      __self: this\n    }, user.blogs.length));\n  }))));\n};\n\nvar User = function User(_ref3) {\n  var user = _ref3.user;\n\n  if (user === undefined) {\n    return null;\n  }\n\n  return React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57\n    },\n    __self: this\n  }, React.createElement(\"h1\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58\n    },\n    __self: this\n  }, user.name), React.createElement(\"h2\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59\n    },\n    __self: this\n  }, \"Added blogs\"), React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60\n    },\n    __self: this\n  }, user.blogs.map(function (b) {\n    return React.createElement(\"li\", {\n      key: b._id,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 62\n      },\n      __self: this\n    }, b.title, \" by \", b.author);\n  })));\n};\n\nvar SingleBlog = function SingleBlog(_ref4) {\n  var blog = _ref4.blog,\n      like = _ref4.like,\n      comment = _ref4.comment,\n      handleChange = _ref4.handleChange;\n\n  if (blog === undefined) {\n    return null;\n  }\n\n  return React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73\n    },\n    __self: this\n  }, React.createElement(\"h1\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74\n    },\n    __self: this\n  }, blog.title), React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75\n    },\n    __self: this\n  }, React.createElement(\"a\", {\n    href: blog.url,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76\n    },\n    __self: this\n  }, blog.url), React.createElement(\"p\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77\n    },\n    __self: this\n  }, blog.likes, \" likes \", React.createElement(\"button\", {\n    onClick: like(blog._id),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77\n    },\n    __self: this\n  }, \"like\")), React.createElement(\"p\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78\n    },\n    __self: this\n  }, \"added by \", blog.user.name)), React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80\n    },\n    __self: this\n  }, React.createElement(\"h2\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81\n    },\n    __self: this\n  }, \"Comments\"), blog.comments.map(function (c) {\n    return React.createElement(\"li\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83\n      },\n      __self: this\n    }, c);\n  })), React.createElement(\"form\", {\n    onSubmit: comment(blog._id),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85\n    },\n    __self: this\n  }, React.createElement(\"input\", {\n    name: \"comment\",\n    onChange: handleChange,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86\n    },\n    __self: this\n  }), React.createElement(\"button\", {\n    type: \"submit\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90\n    },\n    __self: this\n  }, \"add comment\")));\n};\n\nvar App =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(App, _React$Component);\n\n  function App(props) {\n    var _this;\n\n    _classCallCheck(this, App);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(App).call(this, props));\n\n    _this.notify = function (message) {\n      var type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'info';\n\n      _this.props.store.dispatch(changeNotification(message));\n    };\n\n    _this.like = function (id) {\n      return (\n        /*#__PURE__*/\n        _asyncToGenerator(\n        /*#__PURE__*/\n        _regeneratorRuntime.mark(function _callee() {\n          var liked, updated;\n          return _regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  liked = _this.state.blogs.find(function (b) {\n                    return b._id === id;\n                  });\n                  updated = _objectSpread({}, liked, {\n                    likes: liked.likes + 1\n                  });\n                  _context.next = 4;\n                  return blogService.update(id, updated);\n\n                case 4:\n                  _this.notify(\"you liked '\".concat(updated.title, \"' by \").concat(updated.author));\n\n                  _this.setState({\n                    blogs: _this.state.blogs.map(function (b) {\n                      return b._id === id ? updated : b;\n                    })\n                  });\n\n                case 6:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee, this);\n        }))\n      );\n    };\n\n    _this.remove = function (id) {\n      return (\n        /*#__PURE__*/\n        _asyncToGenerator(\n        /*#__PURE__*/\n        _regeneratorRuntime.mark(function _callee2() {\n          var deleted, ok;\n          return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n            while (1) {\n              switch (_context2.prev = _context2.next) {\n                case 0:\n                  deleted = _this.state.blogs.find(function (b) {\n                    return b._id === id;\n                  });\n                  ok = window.confirm(\"remove blog '\".concat(deleted.title, \"' by \").concat(deleted.author, \"?\"));\n\n                  if (!(ok === false)) {\n                    _context2.next = 4;\n                    break;\n                  }\n\n                  return _context2.abrupt(\"return\");\n\n                case 4:\n                  _context2.next = 6;\n                  return blogService.remove(id);\n\n                case 6:\n                  _this.notify(\"blog '\".concat(deleted.title, \"' by \").concat(deleted.author, \" removed\"));\n\n                  _this.setState({\n                    blogs: _this.state.blogs.filter(function (b) {\n                      return b._id !== id;\n                    })\n                  });\n\n                case 8:\n                case \"end\":\n                  return _context2.stop();\n              }\n            }\n          }, _callee2, this);\n        }))\n      );\n    };\n\n    _this.addBlog =\n    /*#__PURE__*/\n    function () {\n      var _ref7 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3(event) {\n        var blog, result;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                event.preventDefault();\n                blog = {\n                  title: _this.state.title,\n                  author: _this.state.author,\n                  url: _this.state.url\n                };\n                _context3.next = 4;\n                return blogService.create(blog);\n\n              case 4:\n                result = _context3.sent;\n\n                _this.notify(\"blog '\".concat(blog.title, \"' by \").concat(blog.author, \" added\"));\n\n                _this.setState({\n                  title: '',\n                  url: '',\n                  author: '',\n                  blogs: _this.state.blogs.concat(result)\n                });\n\n              case 7:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      return function (_x) {\n        return _ref7.apply(this, arguments);\n      };\n    }();\n\n    _this.addComment = function (id) {\n      return (\n        /*#__PURE__*/\n        _asyncToGenerator(\n        /*#__PURE__*/\n        _regeneratorRuntime.mark(function _callee4() {\n          var commentedBlog, comment, updatedBlog;\n          return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n            while (1) {\n              switch (_context4.prev = _context4.next) {\n                case 0:\n                  commentedBlog = _this.blogById(id);\n                  console.log(commentedBlog);\n                  comment = _this.state.comment;\n                  updatedBlog = _objectSpread({}, commentedBlog, {\n                    comments: commentedBlog.comments.concat(comment)\n                  });\n                  _context4.next = 6;\n                  return blogService.update(id, updatedBlog);\n\n                case 6:\n                  _this.notify(\"comment '\".concat(comment, \"' added to blog '\").concat(commentedBlog.title, \"'\"));\n\n                  _this.setState({\n                    comment: ''\n                  });\n\n                case 8:\n                case \"end\":\n                  return _context4.stop();\n              }\n            }\n          }, _callee4, this);\n        }))\n      );\n    };\n\n    _this.logout = function () {\n      window.localStorage.removeItem('loggedBlogAppUser');\n\n      _this.notify('logged out');\n\n      _this.setState({\n        user: null\n      });\n    };\n\n    _this.login =\n    /*#__PURE__*/\n    function () {\n      var _ref9 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee5(event) {\n        var user;\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                event.preventDefault();\n                _context5.prev = 1;\n                _context5.next = 4;\n                return loginService.login({\n                  username: _this.state.username,\n                  password: _this.state.password\n                });\n\n              case 4:\n                user = _context5.sent;\n                window.localStorage.setItem('loggedBlogAppUser', JSON.stringify(user));\n                blogService.setToken(user.token);\n\n                _this.notify('welcome back!');\n\n                _this.setState({\n                  username: '',\n                  password: '',\n                  user: user\n                });\n\n                _context5.next = 15;\n                break;\n\n              case 11:\n                _context5.prev = 11;\n                _context5.t0 = _context5[\"catch\"](1);\n\n                _this.notify('käyttäjätunnus tai salasana virheellinen', 'error');\n\n                setTimeout(function () {\n                  _this.setState({\n                    error: null\n                  });\n                }, 5000);\n\n              case 15:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this, [[1, 11]]);\n      }));\n\n      return function (_x2) {\n        return _ref9.apply(this, arguments);\n      };\n    }();\n\n    _this.handleChange = function (event) {\n      _this.setState(_defineProperty({}, event.target.name, event.target.value));\n    };\n\n    _this.userById = function (id) {\n      return _this.state.users.find(function (u) {\n        return u._id === id;\n      });\n    };\n\n    _this.blogById = function (id) {\n      return _this.state.blogs.find(function (b) {\n        return b._id === id;\n      });\n    };\n\n    _this.state = {\n      blogs: [],\n      user: null,\n      username: '',\n      password: '',\n      title: '',\n      author: '',\n      url: '',\n      users: [],\n      comment: ''\n    };\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      var _this2 = this;\n\n      blogService.getAll().then(function (blogs) {\n        return _this2.setState({\n          blogs: blogs\n        });\n      });\n      userService.getAll().then(function (users) {\n        return _this2.setState({\n          users: users\n        });\n      });\n      var loggedUserJSON = window.localStorage.getItem('loggedBlogAppUser');\n\n      if (loggedUserJSON) {\n        var user = JSON.parse(loggedUserJSON);\n        this.setState({\n          user: user\n        });\n        blogService.setToken(user.token);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      if (this.state.user === null) {\n        return React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 221\n          },\n          __self: this\n        }, React.createElement(Notification, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 222\n          },\n          __self: this\n        }), React.createElement(\"h2\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 223\n          },\n          __self: this\n        }, \"Kirjaudu sovellukseen\"), React.createElement(\"form\", {\n          onSubmit: this.login,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 224\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 225\n          },\n          __self: this\n        }, \"k\\xE4ytt\\xE4j\\xE4tunnus\", React.createElement(\"input\", {\n          type: \"text\",\n          name: \"username\",\n          value: this.state.username,\n          onChange: this.handleChange,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 227\n          },\n          __self: this\n        })), React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 234\n          },\n          __self: this\n        }, \"salasana\", React.createElement(\"input\", {\n          type: \"password\",\n          name: \"password\",\n          value: this.state.password,\n          onChange: this.handleChange,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 236\n          },\n          __self: this\n        })), React.createElement(\"button\", {\n          type: \"submit\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 243\n          },\n          __self: this\n        }, \"kirjaudu\")));\n      }\n\n      var byLikes = function byLikes(b1, b2) {\n        return b2.likes - b1.likes;\n      };\n\n      var blogsInOrder = this.state.blogs.sort(byLikes);\n      return React.createElement(\"div\", {\n        className: \"container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 254\n        },\n        __self: this\n      }, React.createElement(Router, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 255\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 256\n        },\n        __self: this\n      }, React.createElement(Notification, {\n        notification: this.props.store.getState(),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 257\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 258\n        },\n        __self: this\n      }, React.createElement(Link, {\n        to: \"/create\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 259\n        },\n        __self: this\n      }, \"blogs\"), \" \\xA0\", React.createElement(Link, {\n        to: \"/users\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 260\n        },\n        __self: this\n      }, \"users\"), \" \\xA0\", this.state.user.name, \" logged in \", React.createElement(\"button\", {\n        onClick: this.logout,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 261\n        },\n        __self: this\n      }, \"logout\")), React.createElement(Togglable, {\n        buttonLabel: \"uusi blogi\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 265\n        },\n        __self: this\n      }, React.createElement(BlogForm, {\n        handleChange: this.handleChange,\n        title: this.state.title,\n        author: this.state.author,\n        url: this.state.url,\n        handleSubmit: this.addBlog,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 266\n        },\n        __self: this\n      })), React.createElement(Route, {\n        path: \"/create\",\n        render: function render() {\n          return React.createElement(BlogList, {\n            list: blogsInOrder,\n            like: _this3.like,\n            remove: _this3.remove,\n            user: _this3.state.user.username,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 275\n            },\n            __self: this\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 275\n        },\n        __self: this\n      }), React.createElement(Route, {\n        exact: true,\n        path: \"/users\",\n        render: function render() {\n          return React.createElement(UserList, {\n            list: _this3.state.users,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 276\n            },\n            __self: this\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 276\n        },\n        __self: this\n      }), React.createElement(Route, {\n        exact: true,\n        path: \"/users/:id\",\n        render: function render(_ref10) {\n          var match = _ref10.match;\n          return React.createElement(User, {\n            user: _this3.userById(match.params.id),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 278\n            },\n            __self: this\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 277\n        },\n        __self: this\n      }), React.createElement(Route, {\n        exact: true,\n        path: \"/blogs/:id\",\n        render: function render(_ref11) {\n          var match = _ref11.match;\n          return React.createElement(SingleBlog, {\n            blog: _this3.blogById(match.params.id),\n            like: _this3.like,\n            comment: _this3.addComment,\n            handleChange: _this3.handleChange,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 280\n            },\n            __self: this\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 279\n        },\n        __self: this\n      }))));\n    }\n  }]);\n\n  return App;\n}(React.Component);\n\nexport default App;","map":{"version":3,"sources":["/Users/Kullervo/Githubailua/Full_Stack-harjoitustyo/Tehtävät/osa7/frontend/src/App.js"],"names":["React","Blog","BlogForm","Notification","Togglable","blogService","loginService","changeNotification","BrowserRouter","Router","Route","Link","userService","BlogList","list","like","remove","user","map","blog","_id","undefined","username","UserList","name","blogs","length","User","b","title","author","SingleBlog","comment","handleChange","url","likes","comments","c","App","props","notify","message","type","store","dispatch","id","liked","state","find","updated","update","setState","deleted","ok","window","confirm","filter","addBlog","event","preventDefault","create","result","concat","addComment","commentedBlog","blogById","console","log","updatedBlog","logout","localStorage","removeItem","login","password","setItem","JSON","stringify","setToken","token","setTimeout","error","target","value","userById","users","u","getAll","then","loggedUserJSON","getItem","parse","byLikes","b1","b2","blogsInOrder","sort","getState","match","params","Component"],"mappings":"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","sourcesContent":["import React from 'react'\nimport Blog from './components/Blog'\nimport BlogForm from './components/BlogForm'\nimport Notification from './components/Notification'\nimport Togglable from './components/Togglable'\nimport blogService from './services/blogs'\nimport loginService from './services/login'\nimport { changeNotification } from './reducers/notificationReducer'\nimport { BrowserRouter as Router, Route, Link } from 'react-router-dom'\nimport userService from './services/user'\n\n\nconst BlogList = ({ list, like, remove, user }) => (\n  <div>\n    <h2>blogs</h2>\n    {\n      list.map(blog =>\n        <Blog\n          key={blog._id}\n          blog={blog}\n          like={like(blog._id)}\n          remove={remove(blog._id)}\n          deletable={blog.user === undefined || blog.user.username === user}\n        />\n      )\n    }\n  </div>\n)\n\nconst UserList = ({ list }) => (\n  <div>\n    <h2>users</h2>\n    <table>\n      <thead>\n        <tr>\n          <th></th>\n          <th>blogs added</th>\n        </tr>\n      </thead>\n      <tbody>\n        {list.map(user =>\n          <tr key={user._id}>\n            <td><Link to={`users/${user._id}`}>{user.name}</Link></td>\n            <td>{user.blogs.length}</td>\n          </tr>)}\n      </tbody>\n    </table>\n\n  </div>\n)\n\nconst User = ({ user }) => {\n  if (user === undefined) {\n    return null\n  }\n  return (\n    <div>\n      <h1>{user.name}</h1>\n      <h2>Added blogs</h2>\n      <div>\n        {user.blogs.map(b =>\n          <li key={b._id}>{b.title} by {b.author}</li>)}\n      </div>\n    </div>\n  )\n}\n\nconst SingleBlog = ({ blog, like, comment, handleChange }) => {\n  if (blog === undefined) {\n    return null\n  }\n  return (\n    <div>\n      <h1>{blog.title}</h1>\n      <div>\n        <a href={blog.url}>{blog.url}</a>\n        <p>{blog.likes} likes <button onClick={like(blog._id)}>like</button></p>\n        <p>added by {blog.user.name}</p>\n      </div>\n      <div>\n        <h2>Comments</h2>\n        {blog.comments.map(c =>\n          <li>{c}</li>)}\n      </div>\n      <form onSubmit={comment(blog._id)}>\n        <input\n          name='comment'\n          onChange={handleChange}\n        />\n        <button type=\"submit\">add comment</button>\n      </form>\n    </div>\n  )\n}\n\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      blogs: [],\n      user: null,\n      username: '',\n      password: '',\n      title: '',\n      author: '',\n      url: '',\n      users: [],\n      comment: ''\n    }\n  }\n\n  componentWillMount() {\n    blogService.getAll().then(blogs =>\n      this.setState({ blogs })\n    )\n    userService.getAll().then(users =>\n      this.setState({ users }))\n    const loggedUserJSON = window.localStorage.getItem('loggedBlogAppUser')\n    if (loggedUserJSON) {\n      const user = JSON.parse(loggedUserJSON)\n      this.setState({ user })\n      blogService.setToken(user.token)\n    }\n  }\n\n  notify = (message, type = 'info') => {\n    this.props.store.dispatch(\n      changeNotification(message)\n    )\n  }\n\n  like = (id) => async () => {\n    const liked = this.state.blogs.find(b => b._id === id)\n    const updated = { ...liked, likes: liked.likes + 1 }\n    await blogService.update(id, updated)\n    this.notify(`you liked '${updated.title}' by ${updated.author}`)\n    this.setState({\n      blogs: this.state.blogs.map(b => b._id === id ? updated : b)\n    })\n  }\n\n  remove = (id) => async () => {\n    const deleted = this.state.blogs.find(b => b._id === id)\n    const ok = window.confirm(`remove blog '${deleted.title}' by ${deleted.author}?`)\n    if (ok === false) {\n      return\n    }\n\n    await blogService.remove(id)\n    this.notify(`blog '${deleted.title}' by ${deleted.author} removed`)\n    this.setState({\n      blogs: this.state.blogs.filter(b => b._id !== id)\n    })\n  }\n\n  addBlog = async (event) => {\n    event.preventDefault()\n    const blog = {\n      title: this.state.title,\n      author: this.state.author,\n      url: this.state.url,\n    }\n\n    const result = await blogService.create(blog)\n    this.notify(`blog '${blog.title}' by ${blog.author} added`)\n    this.setState({\n      title: '',\n      url: '',\n      author: '',\n      blogs: this.state.blogs.concat(result)\n    })\n  }\n\n  addComment = (id) => async () => {\n    const commentedBlog = this.blogById(id)\n    console.log(commentedBlog)\n    const comment = this.state.comment\n    const updatedBlog = {...commentedBlog, comments: commentedBlog.comments.concat(comment)}\n    await blogService.update(id, updatedBlog)\n    this.notify(`comment '${comment}' added to blog '${commentedBlog.title}'`)\n    this.setState({ comment: '' })\n  }\n\n  logout = () => {\n    window.localStorage.removeItem('loggedBlogAppUser')\n    this.notify('logged out')\n    this.setState({ user: null })\n  }\n\n  login = async (event) => {\n    event.preventDefault()\n    try {\n      const user = await loginService.login({\n        username: this.state.username,\n        password: this.state.password\n      })\n\n      window.localStorage.setItem('loggedBlogAppUser', JSON.stringify(user))\n      blogService.setToken(user.token)\n      this.notify('welcome back!')\n      this.setState({ username: '', password: '', user })\n    } catch (exception) {\n      this.notify('käyttäjätunnus tai salasana virheellinen', 'error')\n      setTimeout(() => {\n        this.setState({ error: null })\n      }, 5000)\n    }\n  }\n\n  handleChange = (event) => {\n    this.setState({ [event.target.name]: event.target.value })\n  }\n\n  userById = (id) => this.state.users.find(u => u._id === id)\n  blogById = (id) => this.state.blogs.find(b => b._id === id)\n\n  render() {\n    if (this.state.user === null) {\n      return (\n        <div>\n          <Notification />\n          <h2>Kirjaudu sovellukseen</h2>\n          <form onSubmit={this.login}>\n            <div>\n              käyttäjätunnus\n              <input\n                type=\"text\"\n                name=\"username\"\n                value={this.state.username}\n                onChange={this.handleChange}\n              />\n            </div>\n            <div>\n              salasana\n              <input\n                type=\"password\"\n                name=\"password\"\n                value={this.state.password}\n                onChange={this.handleChange}\n              />\n            </div>\n            <button type=\"submit\">kirjaudu</button>\n          </form>\n        </div>\n      )\n    }\n\n    const byLikes = (b1, b2) => b2.likes - b1.likes\n\n    const blogsInOrder = this.state.blogs.sort(byLikes)\n\n    return (\n      <div className=\"container\">\n        <Router>\n          <div>\n            <Notification notification={this.props.store.getState()} />\n            <div>\n              <Link to={\"/create\"}>blogs</Link> &nbsp;\n              <Link to={\"/users\"}>users</Link> &nbsp;\n              {this.state.user.name} logged in <button onClick={this.logout}>logout</button>\n            </div>\n\n\n            <Togglable buttonLabel='uusi blogi'>\n              <BlogForm\n                handleChange={this.handleChange}\n                title={this.state.title}\n                author={this.state.author}\n                url={this.state.url}\n                handleSubmit={this.addBlog}\n              />\n            </Togglable>\n\n            <Route path=\"/create\" render={() => <BlogList list={blogsInOrder} like={this.like} remove={this.remove} user={this.state.user.username} />} />\n            <Route exact path=\"/users\" render={() => <UserList list={this.state.users} />} />\n            <Route exact path=\"/users/:id\" render={({ match }) =>\n              <User user={this.userById(match.params.id)} />} />\n            <Route exact path=\"/blogs/:id\" render={({ match }) =>\n              <SingleBlog blog={this.blogById(match.params.id)} like={this.like} comment={this.addComment} handleChange={this.handleChange} />} />\n          </div>\n        </Router>\n      </div>\n\n    )\n  }\n}\n\nexport default App;"]},"metadata":{},"sourceType":"module"}